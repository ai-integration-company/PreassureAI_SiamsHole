# TrainLoop

## Описание

Этот репозиторий содержит код для обучения многозадачной модели глубокого обучения (`MultiTaskResNet`), предназначенной для одновременного решения двух задач на изображениях:

- **Бинарной классификации** (8 меток)
- **Регрессии** (7 числовых признаков)

Задачи связаны с выявлением и анализом геологических или нефтепромысловых явлений по визуальным данным.

Здесь представлен весь необходимый код и инструкции для воспроизведения экспериментов и запуска итоговой модели.

## Структура репозитория

```
.
├── models/
│   └── resnet18_checkpoint.pth
├── data/
│   ├── markup_train.csv
│   ├── hq_markup_train.csv
│   └── TriKotaiNarkota/
│       └── TriKotaiNarkota/
│           └── ... (папки с изображениями)
├── notebooks/
│   └── train_loop.ipynb
└── README.md
```

## Установка зависимостей

Установите зависимости с помощью команды:

```bash
pip install torch torchvision accelerate pandas numpy matplotlib scikit-learn
```

## Подготовка данных

Данные необходимо разместить в папке:

```
data/TriKotaiNarkota/TriKotaiNarkota/
```

Каждая папка внутри должна содержать изображения и соответствующие им бинарные и числовые метки.

## Запуск обучения

Для запуска обучения перейдите в папку `notebooks` и используйте Jupyter-ноутбук `train_loop.ipynb`. 

Основные этапы обучения включают:
- Предобработку данных и их загрузку.
- Нормализацию и обратную денормализацию числовых меток.
- Использование комбинированной функции потерь (BCEWithLogitsLoss, MSE, MAE).
- Оценку модели по различным метрикам.

## Метрики оценки

При оценке модели используются следующие метрики:

- **Бинарная классификация**:
  - Accuracy
  - Macro-F1

- **Регрессия**:
  - Mean Squared Error (MSE)
  - Mean Absolute Error (MAE)

- **Итоговый комбинированный показатель**, учитывающий обе задачи.

## Запуск готовой модели

Для запуска уже обученной модели поместите веса в директорию `models/` и следуйте инструкциям в ноутбуке.

## Контакты

Для любых вопросов открывайте issue в репозитории или обращайтесь к разработчикам проекта.

