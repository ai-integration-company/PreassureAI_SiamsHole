# TrainLoop

## Описание

Этот репозиторий содержит код для обучения многозадачной модели глубокого обучения, предназначенной для одновременного решения двух задач на временных рядах:

- **Бинарной классификации** (8 меток)
- **Регрессии** (7 числовых признаков)

Задачи связаны с выявлением и анализом геологических или нефтепромысловых явлений по визуальным данным.

Здесь представлен весь необходимый код и инструкции для воспроизведения экспериментов и запуска итоговой модели.


## Установка зависимостей

Установите зависимости с помощью команды:

```bash
pip install torch torchvision accelerate pandas numpy matplotlib scikit-learn
```

## Подготовка данных( если не хотите их предобрабатывать сами )


Предобработанные данные необходимо скачать с kaggle https://www.kaggle.com/datasets/vasiliygorelov/trikotainarkota и разместить в папке:

```
data/TriKotaiNarkota/TriKotaiNarkota/
```

Каждая папка внутри должна содержать изображения и соответствующие им бинарные и числовые метки.

```
.
├── TriKotaiNarkota/
│       └── TriKotaiNarkota/
│           └── ... (папки с изображениями)
├── train_loop.ipynb
│    
└── README.md
```

## Запуск обучения

Для запуска обучения перейдите в папку `notebooks` и используйте Jupyter-ноутбук `train_loop.ipynb`. 

Основные этапы обучения включают:
- Предобработку данных и их загрузку.
- Нормализацию и обратную денормализацию числовых меток.
- Использование комбинированной функции потерь (BCEWithLogitsLoss, MSE, MAE).
- Оценку модели по различным метрикам.

## Метрики оценки

При оценке модели используются следующие метрики:

- **Бинарная классификация**:
  - Accuracy
  - Macro-F1

- **Регрессия**:
  - Mean Squared Error (MSE)
  - Mean Absolute Error (MAE)

- **Итоговый комбинированный показатель**, учитывающий обе задачи.

## Подготовка данных

Перейдите в скрипт make_train_with_augs.py и поменяйте поти до датасета в формате как он был предоставлен для обучения с сайта коденрок и запустите скрипт. В итоге из 45к временных рядов получится 270к примеров для обучения.


```
.
├── data/
│   ├── markup_train.csv
│   ├── hq_markup_train.csv
│   └── data/
│       └── (папки с изображениями)/
└── README.md
```

## Контакты

Для любых вопросов открывайте issue в репозитории или обращайтесь к @gsvasiliy.

